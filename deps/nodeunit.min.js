/*!
 * Nodeunit
 * https://github.com/caolan/nodeunit
 * Copyright (c) 2010 Caolan McMahon
 * MIT Licensed
 *
 * json2.js
 * http://www.JSON.org/json2.js
 * Public Domain.
 * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
 */nodeunit=function(){this.JSON||(this.JSON={}),function(){"use strict";function f(a){return a<10?"0"+a:a}typeof Date.prototype.toJSON!=="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\"":"\\\"","\\":"\\\\"},rep;function quote(a){escapable.lastIndex=0;return escapable.test(a)?"\""+a.replace(escapable,function(a){var b=meta[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+"\"":"\""+a+"\""}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i==="object"&&typeof i.toJSON==="function"&&(i=i.toJSON(a)),typeof rep==="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep==="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d==="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}typeof JSON.stringify!=="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c==="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c==="string"&&(indent=c);rep=b;if(b&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw new Error("JSON.stringify");return str("",{"":a})}),typeof JSON.parse!=="function"&&(JSON.parse=function(text,reviver){var j;function walk(a,b){var c,d,e=a[b];if(e&&typeof e==="object")for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}();var assert=this.assert={};var types={};var core={};var nodeunit={};var reporter={};(function(){var a={};var b=this;var c=b.async;typeof module!=="undefined"&&module.exports?module.exports=a:b.async=a,a.noConflict=function(){b.async=c;return a};var d=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c,a)};var e=function(a,b){if(a.map)return a.map(b);var c=[];d(a,function(a,d,e){c.push(b(a,d,e))});return c};var f=function(a,b,c){if(a.reduce)return a.reduce(b,c);d(a,function(a,d,e){c=b(c,a,d,e)});return c};var g=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};var h=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1};a.nextTick=function(a){typeof process=="undefined"||!process.nextTick?setTimeout(a,0):process.nextTick(a)},a.forEach=function(a,b,c){if(!a.length)return c();var e=0;d(a,function(d){b(d,function(b){b?(c(b),c=function(){}):(e++,e==a.length&&c())})})},a.forEachSeries=function(a,b,c){if(!a.length)return c();var d=0;var e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d++,d==a.length?c():e())})};e()};var i=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.forEach].concat(c))}};var j=function(b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[a.forEachSeries].concat(c))}};var k=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){f[a.index]=d,b(c)})},function(a){d(a,f)})};a.map=i(k),a.mapSeries=j(k),a.reduce=function(b,c,d,e){a.forEachSeries(b,function(a,b){d(c,a,function(a,d){c=d,b(a)})},function(a){e(a,c)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(b,c,d,f){var g=e(b,function(a){return a}).reverse();a.reduce(g,c,d,f)},a.foldr=a.reduceRight;var l=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&f.push(a),b()})},function(a){d(e(f.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.filter=i(l),a.filterSeries=j(l),a.select=a.filter,a.selectSeries=a.filterSeries;var m=function(a,b,c,d){var f=[];b=e(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||f.push(a),b()})},function(a){d(e(f.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};a.reject=i(m),a.rejectSeries=j(m);var n=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?d(a):b()})},function(a){d()})};a.detect=i(n),a.detectSeries=j(n),a.some=function(b,c,d){a.forEach(b,function(a,b){c(a,function(a){a&&(d(true),d=function(){}),b()})},function(a){d(false)})},a.any=a.some,a.every=function(b,c,d){a.forEach(b,function(a,b){c(a,function(a){a||(d(false),d=function(){}),b()})},function(a){d(true)})},a.all=a.every,a.sortBy=function(b,c,d){a.map(b,function(a,b){c(a,function(c,d){c?b(c):b(null,{value:a,criteria:d})})},function(a,b){if(a)return d(a);d(null,e(b.sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),function(a){return a.value}))})},a.auto=function(a,b){b=b||function(){};var c=g(a);if(!c.length)return b(null);var e=[];var i=[];var j=function(a){i.unshift(a)};var k=function(a){for(var b=0;b<i.length;b++)if(i[b]===a){i.splice(b,1);return}};var l=function(){d(i,function(a){a()})};j(function(){e.length==c.length&&b(null)}),d(c,function(c){var d=a[c]instanceof Function?[a[c]]:a[c];var g=function(a){a?(b(a),b=function(){}):(e.push(c),l())};var i=d.slice(0,Math.abs(d.length-1))||[];var m=function(){return f(i,function(a,b){return a&&h(e,b)!=-1},true)};if(m())d[d.length-1](g);else{var n=function(){m()&&(k(n),d[d.length-1](g))};j(n)}})},a.waterfall=function(b,c){if(!b.length)return c();c=c||function(){};var d=function(b){return function(e){if(e)c(e),c=function(){};else{var f=Array.prototype.slice.call(arguments,1);var g=b.next();g?f.push(d(g)):f.push(c),a.nextTick(function(){b.apply(null,f)})}}};d(a.iterator(b))()},a.parallel=function(b,c){c=c||function(){},a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c||null)})},c)},a.series=function(b,c){c=c||function(){},a.mapSeries(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c||null)})},c)},a.iterator=function(a){var b=function(c){var d=function(){a.length&&a[c].apply(null,arguments);return d.next()};d.next=function(){return c<a.length-1?b(c+1):null};return d};return b(0)},a.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var o=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};a.concat=i(o),a.concatSeries=j(o);var p=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(b?console.error&&console.error(b):console[a]&&d(c,function(b){console[a](b)}))}]))}};a.log=p("log"),a.dir=p("dir")})(),function(a){var b=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};var c=Array.prototype.slice;var d=a;d.AssertionError=function e(a){this.name="AssertionError",this.message=a.message,this.actual=a.actual,this.expected=a.expected,this.operator=a.operator;var b=a.stackStartFunction||g;Error.captureStackTrace&&Error.captureStackTrace(this,b)},d.AssertionError.super_=Error;var f=function(){this.constructor=d.AssertionError};f.prototype=Error.prototype,d.AssertionError.prototype=new f,d.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",JSON.stringify(this.expected),this.operator,JSON.stringify(this.actual)].join(" ")},d.AssertionError.__proto__=Error.prototype;function g(a,b,c,e,f){throw new d.AssertionError({message:c,actual:a,expected:b,operator:e,stackStartFunction:f})}d.fail=g,d.ok=function h(a,b){!!a||g(a,true,b,"==",d.ok)},d.equal=function i(a,b,c){a!=b&&g(a,b,c,"==",d.equal)},d.notEqual=function j(a,b,c){a==b&&g(a,b,c,"!=",d.notEqual)},d.deepEqual=function k(a,b,c){l(a,b)||g(a,b,c,"deepEqual",d.deepEqual)};function l(a,b){return a===b?true:a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():typeof a!="object"&&typeof b!="object"?a==b:o(a,b)}function m(a){return a===null||a===undefined}function n(a){return Object.prototype.toString.call(a)=="[object Arguments]"}function o(a,d){if(m(a)||m(d))return false;if(a.prototype!==d.prototype)return false;if(n(a)){if(!n(d))return false;a=c.call(a),d=c.call(d);return l(a,d)}try{var e=b(a),f=b(d),g,h}catch(i){return false}if(e.length!=f.length)return false;e.sort(),f.sort();for(h=e.length-1;h>=0;h--)if(e[h]!=f[h])return false;for(h=e.length-1;h>=0;h--){g=e[h];if(!l(a[g],d[g]))return false}return true}d.notDeepEqual=function p(a,b,c){l(a,b)&&g(a,b,c,"notDeepEqual",d.notDeepEqual)},d.strictEqual=function q(a,b,c){a!==b&&g(a,b,c,"===",d.strictEqual)},d.notStrictEqual=function r(a,b,c){a===b&&g(a,b,c,"!==",d.notStrictEqual)};function s(a,b,c,d){var e=null,f=false,h=true;d=d||"",arguments.length==3?typeof c=="string"&&(d=c,h=false):arguments.length==2&&(h=false);try{b()}catch(i){f=true,e=i}a&&!f&&g("Missing expected exception"+(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"")),!a&&f&&h&&e instanceof c&&g("Got unwanted exception"+(c&&c.name?" ("+c.name+").":".")+(d?" "+d:""));if(a&&f&&h&&!(e instanceof c)||!a&&f)throw e}d.throws=function(a,b,d){s.apply(this,[true].concat(c.call(arguments)))},d.doesNotThrow=function(a,b,d){s.apply(this,[false].concat(c.call(arguments)))},d.ifError=function(a){if(a)throw a}}(assert),function(a){a.assertion=function(a){return{method:a.method||"",message:a.message||a.error&&a.error.message||"",error:a.error,passed:function(){return!this.error},failed:function(){return Boolean(this.error)}}},a.assertionList=function(a,b){var c=a||[];c.failures=function(){var a=0;for(var b=0;b<this.length;b++)this[b].failed()&&a++;return a},c.duration=b||0;return c};var b=function(b){return function(c,d,e){return function(){var f=arguments[e-1];var g=a.assertion({method:c,message:f});try{assert[d].apply(null,arguments)}catch(h){g.error=h}b(g)}}};a.test=function(c,d,e,f){var g;var h=[];var i=b(function(a){h.push(a),async.nextTick(function(){e.log(a)})});var j={done:function(b){if(g!==undefined&&g!==h.length){var i=new Error("Expected "+g+" assertions, "+h.length+" ran");var j=a.assertion({method:"expect",error:i});h.push(j),async.nextTick(function(){e.log(j)})}if(b){var k=a.assertion({error:b});h.push(k),async.nextTick(function(){e.log(k)})}var l=(new Date).getTime();async.nextTick(function(){var b=a.assertionList(h,l-d);e.testDone(c,b),f(null,h)})},ok:i("ok","ok",2),same:i("same","deepEqual",3),equals:i("equals","equal",3),expect:function(a){g=a},_assertion_list:h};for(var k in assert)assert.hasOwnProperty(k)&&(j[k]=i(k,k,assert[k].length));return j},a.options=function(a){var b=function(b){a[b]=a[b]||function(){}};b("moduleStart"),b("moduleDone"),b("testStart"),b("testDone"),b("log");return a}}(types),function(a){var b=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};a.runTest=function(a,b,c,d){var e=types.options(c);e.testStart(a);var f=(new Date).getTime();var g=types.test(a,f,e,d);try{b(g)}catch(h){g.done(h)}},a.runSuite=function(c,d,e,f){var g=b(d);async.concatSeries(g,function(b,f){var g=d[b],h;h=c?[].concat(c,b):[b],h.toString=function(){return this.join(" - ")},typeof g==="function"?a.runTest(h,d[b],e,f):a.runSuite(h,d[b],e,f)},f)},a.runModule=function(b,c,d,e){var f=types.options(d);f.moduleStart(b);var g=(new Date).getTime();a.runSuite(null,c,d,function(a,c){var d=(new Date).getTime();var h=types.assertionList(c,d-g);f.moduleDone(b,h),e(null,c)})},a.runModules=function(c,d){var e=[];var f=types.options(d);var g=(new Date).getTime();async.concatSeries(b(c),function(b,d){a.runModule(b,c[b],f,d)},function(a,b){var c=(new Date).getTime();f.done(types.assertionList(b,c-g))})},a.testCase=function(a){var c={};var d=a.setUp;var e=a.tearDown;delete a.setUp,delete a.tearDown;var f=b(a);var c={};for(var g=0;g<f.length;g++)(function(b){c[b]=function(c){var f={};if(e){var g=c.done;c.done=function(a){try{e.call(f,function(b){if(a&&b){c._assertion_list.push(types.assertion({error:a}));return g(b)}g(a||b)})}catch(b){g(b)}}}d?d.call(f,function(d){if(d)return c.done(d);a[b].call(f,c)}):a[b].call(f,c)}})(f[g]);return c}}(core),function(a){a.info="Browser-based test reporter",a.addStyles=function(){document.body.innerHTML+="<style type=\"text/css\">body { font: 12px Helvetica Neue }h2 { margin:0 ; padding:0 }pre {font: 11px Andale Mono;margin-left: 1em;padding-left: 1em;margin-top: 0;font-size:smaller;}.assertion_message { margin-left: 1em; }  ol {list-style: none;margin-left: 1em;padding-left: 1em;text-indent: -1em;}  ol li.pass:before { content: \"\\2714 \\0020\"; }  ol li.fail:before { content: \"\\2716 \\0020\"; }</style>"},a.run=function(b,c){var d=(new Date).getTime();a.addStyles();var e="";nodeunit.runModules(b,{moduleStart:function(a){e+="<h2>"+a+"</h2>",e+="<ol>"},testDone:function(a,b){if(b.failures()){e+="<li class=\"fail\">"+a;for(var c=0;c<b.length;c++){var d=b[c];d.failed()&&(d.error instanceof assert.AssertionError&&d.message&&(e+="<div class=\"assertion_message\">Assertion Message: "+d.message+"</div>"),e+="<pre>",e+=d.error.stack||d.error,e+="</pre>")}e+="</li>"}else e+="<li class=\"pass\">"+a+"</li>"},moduleDone:function(){e+="</ol>"},done:function(a){var b=(new Date).getTime();var c=b-d;a.failures()?e+="<h3>FAILURES: "+a.failures()+"/"+a.length+" assertions failed ("+a.duration+"ms)</h3>":e+="<h3>OK: "+a.length+" assertions ("+a.duration+"ms)</h3>",document.body.innerHTML+=e}})}}(reporter),nodeunit=core,nodeunit.assert=assert,nodeunit.reporter=reporter,nodeunit.run=reporter.run;return nodeunit}()